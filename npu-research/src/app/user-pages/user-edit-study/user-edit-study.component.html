<div class="bg-gray-100 min-h-screen p-6">
  <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow p-8 space-y-10">
    <!-- Header -->
    <div>
      <h1 class="text-3xl text-gray-800">แก้ไขข้อมูลนักวิจัย</h1>
      <div class="flex items-center gap-2 mt-3 text-indigo-600">
        <i class="bi bi-pencil-square"></i>
        <span>ข้อมูลการศึกษา</span>
      </div>
      <hr class="mt-4" />
    </div>

    <div class="flex justify-end">
      <button (click)="openModal()" class="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition"><i class="bi bi-plus"></i>เพิ่มข้อมูลการศึกษา</button>
    </div>

    <div class="w-full overflow-x-auto">
      <table
        class="min-w-225 w-full border border-gray-300 rounded-lg overflow-hidden mt-4"
      >
        <thead>
          <tr class="bg-[#FACC15] text-[#1E293B] border-b">
            <th class="p-3 text-left whitespace-nowrap">ระดับ</th>
            <th class="p-3 text-left">สาขา/คุณวุฒิ</th>
            <th class="p-3 text-left">สถานศึกษา</th>
            <th class="p-3 text-left">ประเทศ</th>
            <th class="p-3 text-left whitespace-nowrap">เกรดเฉลี่ย(GPAX)</th>
            <th class="p-3 text-left whitespace-nowrap">ปีที่เข้าศึกษา</th>
            <th class="p-3 text-left whitespace-nowrap">ปีที่สำเร็จการศึกษา</th>
            <th class="p-3 text-left whitespace-nowrap">แก้ไข</th>
          </tr>
        </thead>
    
        <tbody>
          <tr
            
            class="border-b hover:bg-gray-50 transition"
          >
    
            <td
              class="p-3 max-w-87.5 wrap-break-word"
            >
              ปริญญาเอก
            </td>
    
            <td class="p-3 max-w-60 wrap-break-word">
              วิศวกรรมคอมพิวเตอร์
            </td>
    
            <td class="p-3 max-w-55 wrap-break-word">
              มหาวิทยาลัยนครพนม
            </td>
    
            <td class="p-3 whitespace-nowrap">
              ไทยแลนด์
            </td>
    
            <td class="p-3 whitespace-nowrap">
              4.00
            </td>
            <td class="p-3 whitespace-nowrap">
              1/1/2020
            </td>
            <td class="p-3 whitespace-nowrap">
              1/1/2024
            </td>
            <td class="p-3 whitespace-nowrap">
              <i (click)="openModalEdit()" class="bi bi-pencil mr-3 text-sky-500 cursor-pointer hover:text-sky-700"></i>
              <i class="bi bi-trash3 text-red-500 cursor-pointer hover:text-red-700"></i>
            </td>
          </tr>
        </tbody>
      </table>
  </div>
  <!-- ปุ่ม -->
  <div class="flex justify-center mt-6">
    <button
      type="submit"
      (click)="save()"
      class="px-6 py-2 bg-[#FDE68A] text-[#1E293B] hover:bg-[#FACC15] rounded-md transition cursor-pointer"
    >
      บันทึกข้อมูล
    </button>
  </div>
  </div>
</div>


<!-- ======= Modal ========= -->
<!-- Modal Backdrop -->
<div
  *ngIf="isModalOpen"
  class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center"
>
  <!-- Modal Box -->
  <div
    class="bg-white w-full max-w-xl rounded-2xl shadow-xl p-6 relative"
  >
    <!-- Header -->
    <div class="flex items-center justify-between border-b pb-3 mb-5">
      <h2 class="text-lg font-semibold text-gray-800">
        เพิ่มข้อมูลการศึกษา
      </h2>
      <button
        (click)="closeModal()"
        class="text-gray-400 hover:text-gray-600 transition"
      >
        <i class="bi bi-x-lg text-lg"></i>
      </button>
    </div>

    <!-- Content -->
    <div class="space-y-4">

      <!-- ====== Education Level ===== -->
      <div class="relative">
        <label class="text-sm text-gray-600 mb-1 block">ระดับการศึกษา</label>
        <button
          (click)="toggle('education', $event)"
          class="flex justify-between items-center w-full border rounded-lg px-3 py-2 hover:border-indigo-500 transition"
        >
          <span class="text-gray-700">
            {{ selectedEducationLevel || 'เลือก' }}
          </span>
          <i class="bi bi-chevron-down text-sm"></i>
        </button>

        <div
          *ngIf="isOpen('education')"
          class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          (click)="$event.stopPropagation()"
        >
          <input
            [(ngModel)]="searchEducationLevel"
            placeholder="ค้นหา..."
            class="w-full px-3 py-2 border-b text-sm outline-none"
          />
          <ul class="max-h-44 overflow-y-auto text-sm">
            <li
              *ngFor="let e of filteredEducationLevel()"
              (click)="selectEducationLevel(e)"
              class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
            >
              {{ e }}
            </li>
            <li
              *ngIf="filteredEducationLevel().length === 0"
              class="px-4 py-2 text-gray-400 text-center"
            >
              ไม่พบข้อมูล
            </li>
          </ul>
        </div>
      </div>

      <!-- ====== Major & Qualification ===== -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Major -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">สาขา</label>
          <button
            (click)="toggle('majors', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedMajors || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('majors')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchMajors"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let m of filteredMajor()"
                (click)="selectMajor(m)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ m }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Qualification -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">คุณวุฒิ</label>
          <button
            (click)="toggle('qualifications', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedQualifications || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('qualifications')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchQualifications"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let q of filteredQualification()"
                (click)="selectQualification(q)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ q }}
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ===== Institution & Country ===== -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Institution -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">สถานที่ศึกษา</label>
          <button
            (click)="toggle('institutions', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedInstitutions || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('institutions')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchInstitutions"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let i of filteredInstitution()"
                (click)="selectInstitution(i)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ i }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Country -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">ประเทศ</label>
          <button
            (click)="toggle('countries', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedCountries || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('countries')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchCountries"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let c of filteredCountries()"
                (click)="selectCountrie(c)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
              {{ c.name }} ({{ c.code }})
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ===== GPA & Year ===== -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <input
          type="text"
          placeholder="เกรดเฉลี่ย"
          class="w-full border rounded-lg px-3 py-2"
        />
        <input
          type="text"
          placeholder="ปีที่เข้าศึกษา"
          class="w-full border rounded-lg px-3 py-2"
        />
        <input
          type="text"
          placeholder="ปีที่สำเร็จการศึกษา"
          class="w-full border rounded-lg px-3 py-2"
        />
      </div>
    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
      <button
        (click)="closeModal()"
        class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-100"
      >
        ยกเลิก
      </button>
      <button
      (click)="saveAdd()"
        class="px-5 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 shadow"
      >
        บันทึก
      </button>
    </div>
  </div>
</div>


<!-- ====== Modal Edit ====== -->
<div
  *ngIf="isModalOpenEdit"
  class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center"
>
  <!-- Modal Box -->
  <div
    class="bg-white w-full max-w-xl rounded-2xl shadow-xl p-6 relative"
  >
    <!-- Header -->
    <div class="flex items-center justify-between border-b pb-3 mb-5">
      <h2 class="text-lg font-semibold text-gray-800">
        แก้ไขข้อมูลการศึกษา
      </h2>
      <button
        (click)="closeModalEdit()"
        class="text-gray-400 hover:text-gray-600 transition"
      >
        <i class="bi bi-x-lg text-lg"></i>
      </button>
    </div>

    <!-- Content -->
    <div class="space-y-4">

      <!-- ====== Education Level ===== -->
      <div class="relative">
        <label class="text-sm text-gray-600 mb-1 block">ระดับการศึกษา</label>
        <button
          (click)="toggle('education', $event)"
          class="flex justify-between items-center w-full border rounded-lg px-3 py-2 hover:border-indigo-500 transition"
        >
          <span class="text-gray-700">
            {{ selectedEducationLevel || 'เลือก' }}
          </span>
          <i class="bi bi-chevron-down text-sm"></i>
        </button>

        <div
          *ngIf="isOpen('education')"
          (click)="$event.stopPropagation()"
          class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
        >
          <input
            [(ngModel)]="searchEducationLevel"
            placeholder="ค้นหา..."
            class="w-full px-3 py-2 border-b text-sm outline-none"
          />
          <ul class="max-h-44 overflow-y-auto text-sm">
            <li
              *ngFor="let e of filteredEducationLevel()"
              (click)="selectEducationLevel(e)"
              class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
            >
              {{ e }}
            </li>
            <li
              *ngIf="filteredEducationLevel().length === 0"
              class="px-4 py-2 text-gray-400 text-center"
            >
              ไม่พบข้อมูล
            </li>
          </ul>
        </div>
      </div>

      <!-- ====== Major & Qualification ===== -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Major -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">สาขา</label>
          <button
            (click)="toggle('majors', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedMajors || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('majors')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchMajors"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let m of filteredMajor()"
                (click)="selectMajor(m)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ m }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Qualification -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">คุณวุฒิ</label>
          <button
            (click)="toggle('qualifications', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedQualifications || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('qualifications')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchQualifications"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let q of filteredQualification()"
                (click)="selectQualification(q)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ q }}
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ===== Institution & Country ===== -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Institution -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">สถานที่ศึกษา</label>
          <button
            (click)="toggle('institutions', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedInstitutions || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('institutions')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchInstitutions"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let i of filteredInstitution()"
                (click)="selectInstitution(i)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ i }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Country -->
        <div class="relative">
          <label class="text-sm text-gray-600 mb-1 block">ประเทศ</label>
          <button
            (click)="toggle('countries', $event)"
            class="flex justify-between items-center w-full border rounded-lg px-3 py-2"
          >
            {{ selectedCountries || 'เลือก' }}
            <i class="bi bi-chevron-down text-sm"></i>
          </button>

          <div
            *ngIf="isOpen('countries')"
            (click)="$event.stopPropagation()"
            class="absolute z-50 w-full bg-white border rounded-lg shadow mt-1"
          >
            <input
              [(ngModel)]="searchCountries"
              placeholder="ค้นหา..."
              class="w-full px-3 py-2 border-b text-sm"
            />
            <ul class="max-h-44 overflow-y-auto text-sm">
              <li
                *ngFor="let c of filteredCountries()"
                (click)="selectCountrie(c)"
                class="px-4 py-2 hover:bg-indigo-50 cursor-pointer"
              >
                {{ c.name }} ({{ c.code }})
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ===== GPA & Year ===== -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <input
          type="text"
          placeholder="เกรดเฉลี่ย"
          class="w-full border rounded-lg px-3 py-2"
        />
        <input
          type="text"
          placeholder="ปีที่เข้าศึกษา"
          class="w-full border rounded-lg px-3 py-2"
        />
        <input
          type="text"
          placeholder="ปีที่สำเร็จการศึกษา"
          class="w-full border rounded-lg px-3 py-2"
        />
      </div>
    </div>

    <!-- Footer -->
    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
      <button
        (click)="closeModalEdit()"
        class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-100"
      >
        ยกเลิก
      </button>
      <button
        class="px-5 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 shadow"
      >
        บันทึก
      </button>
    </div>
  </div>
</div>

